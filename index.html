<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Hexo</title><meta name="author" content="John Doe"><meta name="copyright" content="John Doe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hexo',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-05-24 14:00:40'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a></div></div></div><hr/></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Hexo</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Hexo</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info"><a class="article-title" href="/2021/05/24/hello-world/" title="Hello World">Hello World</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-05-24T03:59:43.500Z" title="Created 2021-05-24 11:59:43">2021-05-24</time></span></div><div class="content">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.
Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;

More info: Writing
Run server1$ hexo server

More info: Server
Generate static files1$ hexo generate

More info: Generating
Deploy to remote sites1$ hexo deploy

More info: Deployment
</div></div></div><div class="recent-post-item"><div class="recent-post-info"><a class="article-title" href="/2021/03/16/TP5-RCE%E5%88%86%E6%9E%90/" title="TP5 RCE分析">TP5 RCE分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-03-16T15:05:13.000Z" title="Created 2021-03-16 23:05:13">2021-03-16</time></span></div><div class="content">RCE1参考：https://www.anquanke.com/post/id/177173#h2-14
https://xz.aliyun.com/t/3570#toc-0
https://xz.aliyun.com/t/7792#toc-0
https://hack-for.fun/a45.html#%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93
https://xz.aliyun.com/t/3845
https://mp.weixin.qq.com/s/DGWuSdB2DvJszom0C_dkoQ
影响版本12TP 5.0.7 - 5.0.24TP 5.1.0 - 5.1.30

payload5.0
12345?s=index/think\config/get&amp;name=database.username // 获取配置信息?s=index/\think\Lang/load&amp;file=../../test.jpg    // 包含任意文件?s=index/\think\Config/load&amp;file=../../t.php  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info"><a class="article-title" href="/2021/01/21/vulnstack-%E7%BA%A2%E9%98%9F%E4%B8%80/" title="vulnstack 红队一">vulnstack 红队一</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-01-21T10:44:33.000Z" title="Created 2021-01-21 18:44:33">2021-01-21</time></span></div><div class="content">环境搭建配置网卡

编辑-&gt;虚拟网络编辑器


自定义为仅主机模式
配置win7网络
添加两块网卡,一块为VMnet1(仅主机模式),一块为VMnet8(net模式连通外网)
配置VMnet1网卡 (win7)

DNS服务器是windows server的ip, vulnstack配置好了
使用win7 ping一下 windows server, 能ping同则成功
配置好后加入域

控制面板-&gt;系统安全-&gt;系统-&gt;高级系统设置,  加入域时会提示已有域用户,登录即可.

此时kali win7都使用VMnet8 都处于同一网段下, 都可访问外网
kali

win7

拿下win7
如果访问不了网站可能是防火墙的原因, 将apache mysql的程序全部允许通过防火墙即可

目录扫描

phpmyadmin弱口令弱口令登录(root root)

日志拿shell
1234567查看日志状况 show variables like &quot;%log%&quot;开启日志 set global general_log=&#x27;on&#x27;修改日 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info"><a class="article-title" href="/2020/12/21/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="数据结构">数据结构</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2020-12-21T13:59:20.000Z" title="Created 2020-12-21 21:59:20">2020-12-21</time></span></div><div class="content">数据结构术语12345678910111213141516171819202122232425262728结构是指数据间的关系数据结构是指 相互之间存在某种特定关系的数据元素的集合数据结构包括三方面	数据的逻辑结构	数据的存储结构	数据的运算一个算法的设计取决于选定的逻辑结构，算法的实现依赖于采用的存储结构	线性 一对一树状 一对多网状 多对多数据结构是一个二元组 (D,R), D是数据元素的有限集, R是D上关系的有限集数据结构的5个重要特性 (算法的特征)有穷性确定性可行性输入, 输出算法要求可读性 健壮性 效率与储存需求时间复杂度排序O(1) &lt; O(log₂n) &lt; O(n) &lt; O(n*log₂n ) &lt; O(n2)&lt; O(n3)…&lt;O(2n)&lt;O(3n)&lt;…&lt;O(n!)



顺序线性表0.线性表类型定义123同一性有穷性有序性



1. 顺序表定义
定义

12345typedef struct&#123;	char data[max]; //数据(数组)	int length;   //长度&#125;sqlist ...</div></div></div><div class="recent-post-item"><div class="recent-post-info"><a class="article-title" href="/2020/12/08/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E/" title="中间件漏洞">中间件漏洞</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2020-12-08T11:06:38.000Z" title="Created 2020-12-08 19:06:38">2020-12-08</time></span></div><div class="content">apachephp常见运行方式有 apache的模块模式(分为mod_php和mod_cgi) cgi模式, fast-cgi模式

cgi模式就是建立在多进程上的, 但是cgi的每一次请求都会有启动和退出的过程(fork-and-execute模式, 启动脚本解析器解析php.ini 初始化运行环境, 载入dll), 这在高并发时性能非常弱.

fast-cgi就是为了解决cgi的问题而诞生的, web server 启动时 会启动fastcgi进程管理器, fastcgi进程管理器读取php.ini文件并初始化, 然后启动多个cgi解释器进程(php-cgi), 当收到请求时,web server会将相关数据发送到fastcgi的子进程 php-cgi中处理.

apache模块模式

mod_php模式, apache调用与php相关模块(apache内置), 将php当做apache子模块运行. apache每收到一个请求就会启动一个进程并通过sapi(php和外部通信的接口)来连接php

mod_cgi/mod_fcgid模式 使用cgi或者fast-cgi实现.




 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info"><a class="article-title" href="/2020/11/22/Linux%E6%8F%90%E6%9D%83/" title="Linux提权">Linux提权</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2020-11-22T09:33:32.000Z" title="Created 2020-11-22 17:33:32">2020-11-22</time></span></div><div class="content">SUID提权SUID GUID Stickybitsuid  4 ,  sgid 2 , Stickybit(粘滞位)  1
Umask: root的umask为0022 ,第一位是上一排提到的, 所以创建文件时就是777-022=755, 文件就是 755-111=644 除去x(执行权)
Stickybit(粘滞位)
12修饰文件夹  文件只有自己和root用户可以修改如/tmp目录 所以用户都可创建修改自己文件, 但无法修改其他用户文件(无论是否同一个组)

SGID
123用于目录，在该目录下建立的所有文件和目录，属组都继承该目录的属组，且该组内其他成员修改目录内的文件时，其属主和属组都不改变!!  chmod g+s 目录当修改文件两个用户是other(other和组内成员)时会改变所属主(所属组不变)

suid有啥用?
普通用户连/etc/shadow的查看权都没有, 但是要修改密码怎么办, 就是利用passwd的suid, 让passwd以root身份执行 赋予s权限需要本身具有x权限
chmod  4755  前面的4就是SUID

SUID只对可执行文件有效
调用者 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info"><a class="article-title" href="/2020/11/22/phpmyadmin%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/" title="phpmyadmin漏洞利用">phpmyadmin漏洞利用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2020-11-22T08:57:47.000Z" title="Created 2020-11-22 16:57:47">2020-11-22</time></span></div><div class="content">phpmyadmin漏洞利用获取版本信息访问
1234567readme.phpREADMEchangelog.phpChangeDocumetation.htmlDocumetation.txttranslators.html


getshell
使用爆破工具 , 或者得到账号密码 直接登录

写入文件12345条件拥有root权限网站路径拥有写权限


获取路径方法

123456789phpinfo  某些网站安装完成后 测试文件可能没有删除 phpinfo.php、info.php、1.php、test.php查寻mysql路径猜测web路径select @@datadir as dataPath from dual ;或者show variables Like &#x27;%datadir%&#x27;;load_file读取网站配置文件 index.php 或者 /etc/passwd等等


查询写权限

1234567SHOW VARIABLES LIKE &#x27;secure_file_priv&#x27;secure_file_priv作用1. 限制load  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info"><a class="article-title" href="/2020/11/22/MYSQL%E6%8F%90%E6%9D%83%E5%A4%8D%E7%8E%B0/" title="MYSQL提权复现">MYSQL提权复现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2020-11-22T08:21:40.000Z" title="Created 2020-11-22 16:21:40">2020-11-22</time></span></div><div class="content">[toc]
1234mysql写权限查询写权限show variables like &quot;secure_file_priv&quot;;查询结果不能为null


修改配置文件 windows下为my.ini   linux为my.cnf
secure_file_priv =’’ 
null为不允许导入导出
空白则为任意
/tmp则为只能在/tmp目录下

1234查看mysql pulgin文件目录	show variables like &quot;pulgin%&quot;;查看系统版本	show variables like &quot;%compile%&quot;;



mof提权(失败)
在windows的C:/windows/system32/wbem/mof/nullevt.mof文件中, 会间接以系统权限执行一次, 写入我们的恶意代码即可被系统执行

1select load_file(&quot;上传文件的路径/evil.mof&quot;) into dumpfile &quot;C:/windows/system32/wbem/mof/nullevt ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">John Doe</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><div class="content"><a class="title" href="/2021/05/24/hello-world/" title="Hello World">Hello World</a><time datetime="2021-05-24T03:59:43.500Z" title="Created 2021-05-24 11:59:43">2021-05-24</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/2021/03/16/TP5-RCE%E5%88%86%E6%9E%90/" title="TP5 RCE分析">TP5 RCE分析</a><time datetime="2021-03-16T15:05:13.000Z" title="Created 2021-03-16 23:05:13">2021-03-16</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/2021/01/21/vulnstack-%E7%BA%A2%E9%98%9F%E4%B8%80/" title="vulnstack 红队一">vulnstack 红队一</a><time datetime="2021-01-21T10:44:33.000Z" title="Created 2021-01-21 18:44:33">2021-01-21</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/2020/12/21/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="数据结构">数据结构</a><time datetime="2020-12-21T13:59:20.000Z" title="Created 2020-12-21 21:59:20">2020-12-21</time></div></div><div class="aside-list-item"><div class="content"><a class="title" href="/2020/12/08/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E/" title="中间件漏洞">中间件漏洞</a><time datetime="2020-12-08T11:06:38.000Z" title="Created 2020-12-08 19:06:38">2020-12-08</time></div></div></div></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size: 1.3em; color: #99a1ac">提权</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.1em; color: #999">数据结构</a> <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/" style="font-size: 1.5em; color: #99a9bf">漏洞利用</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/05/"><span class="card-archive-list-date">May 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/03/"><span class="card-archive-list-date">March 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/01/"><span class="card-archive-list-date">January 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/12/"><span class="card-archive-list-date">December 2020</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/11/"><span class="card-archive-list-date">November 2020</span><span class="card-archive-list-count">3</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">8</div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-05-24T06:00:40.694Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By John Doe</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>